<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Data Sources</title>
        <link rel="stylesheet" href="style.css">
    </head>    
    <body>
        <header>
            <h1>AI4Cyber - Group 6</h1>
        </header>

        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="industry-background.html">Industry Background</a></li>
            <li><a href="threat-modeling.html">Threat Modeling</a></li>
            <li><a href="data-sources.html" class="active">Data</a></li>
            <li><a href="about-us.html">About Us</a></li>
        </ul>

        <section>
            <h2>Data Sources</h2>
            <p>
                Explore data sources relevant to healthcare cyber threats.
            </p>
            <p>
                Samples of each data source are included below, along with a description of the data and its purpose in battling healthcare cybersecurity threats.
            </p>
        </section>

        <section>
            <h3>PhishTank</h3>

            <p><b>Background</b></p>
            <p>PhishTank is a public database of phishing emails collected by the Internet Security Agency. ~ADD MORE HERE~</p>

            <p><b>Justification</b></p>
            <p>ADD JUSTIFICATION HERE</p>

            <p><b>Collection</b></p>
            <p>ADD COLLECTION INFO HERE</p>
            
            <p><b>Data Sample</b></p>
            <div id="phishtank-sample-table" style="overflow-x: auto; overflow-y: auto; width: 90%; height: 300px; border: 3px solid #333; border-radius: 5px; margin-left: auto; margin-right: auto;"></div>
        </section>

        <section>
            <h3>NIST NVD</h3>

            <p><b>Background</b></p>
            <p>ADD BACKGROUND HERE~</p>

            <p><b>Justification</b></p>
            <p>ADD JUSTIFICATION HERE</p>

            <p><b>Collection</b></p>
            <p>ADD COLLECTION INFO HERE</p>
            
            <p><b>Data Sample</b></p>
            <div id="nvd-sample-table" style="overflow-x: auto; overflow-y: auto; width: 90%; height: 300px; border: 3px solid #333; border-radius: 5px; margin-left: auto; margin-right: auto;"></div>
        </section>

        <script>
            // Function to load JSON data and create a table
            function loadAndDisplayJSON() {
                fetch('phishtank_sample_data.json')
                    .then(response => response.json())
                    .then(data => {
                        createTable(data, 'phishtank-sample-table');
                    })
                    .catch(error => console.error('Error:', error));
            }

            function loadAndDisplayCSV() {
                fetch('cves_with_cvss_scores_detailed_no_duplicates.csv')
                    .then(response => response.text())
                    .then(csv => {
                        const data = parseCSV(csv);
                        createTable(data, 'nvd-sample-table');
                    })
                    .catch(error => console.error('Error:', error));
            }

            function parseCSV(csv) {
                const rows = csv.split('\n').filter(line => line.trim());
                const result = [];
                
                // Splitting each row into fields considering commas inside double quotes
                rows.forEach((row, index) => {
                    const fields = [];
                    let field = '';
                    let insideQuotes = false;

                    for (let char of row) {
                        if (char === '"' && field === '') {
                            insideQuotes = !insideQuotes;
                        } else if (char === '"' && insideQuotes) {
                            insideQuotes = false;
                        } else if (char === ',' && !insideQuotes) {
                            fields.push(field);
                            field = '';
                        } else {
                            field += char;
                        }
                    }

                    // Add the last field
                    fields.push(field);

                    // For the header row, create headers array
                    if (index === 0) {
                        result.headers = fields.map(header => header.trim());
                    } else {
                        // For other rows, create objects with keys as headers
                        let obj = {};
                        fields.forEach((f, i) => {
                            obj[result.headers[i]] = f.trim();
                        });
                        result.push(obj);
                    }
                });

                return result;
            }


            // Function to create a table from JSON data
            function createTable(data, containerId) {
                const container = document.getElementById(containerId); // Fixed this line
                const table = document.createElement('table');

                // Add table headers
                const headers = Object.keys(data[0]);
                const headerRow = document.createElement('tr');
                headers.forEach(header => {
                    const th = document.createElement('th');
                    th.textContent = header;
                    headerRow.appendChild(th);
                });
                table.appendChild(headerRow);

                // Add table rows
                data.forEach(item => {
                    const row = document.createElement('tr');
                    Object.values(item).forEach(value => {
                        const cell = document.createElement('td');
                        cell.textContent = value;
                        row.appendChild(cell);
                    });
                    table.appendChild(row);
                });

                container.appendChild(table);
            }


            // Call the function on window load
            window.onload = loadAndDisplayJSON();
            window.onload = loadAndDisplayCSV();
        </script>
    </body>
    <footer>
        <p>Disclaimer: All content on this site is for educational purposes only.</p>
    </footer>
</html>
